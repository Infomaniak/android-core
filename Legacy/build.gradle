apply plugin: 'com.android.library'
apply plugin: 'kotlin-android'
apply plugin: 'kotlin-parcelize'
apply plugin: 'kotlinx-serialization'
apply plugin: 'com.google.devtools.ksp'
apply plugin: 'androidx.navigation.safeargs.kotlin'

rootProject.ext {
    legacyCompileSdk = 35
    legacyMinSdk = 27
}

def legacyCompileSdk = rootProject.ext["legacyCompileSdk"]
def legacyMinSdk = rootProject.ext["legacyMinSdk"]
def javaVersion = rootProject.ext["javaVersion"]

android {
    namespace 'com.infomaniak.lib.core'
    compileSdk legacyCompileSdk

    defaultConfig {
        minSdk legacyMinSdk
        targetSdk legacyCompileSdk

        testOptions.unitTests.includeAndroidResources = true
        testInstrumentationRunner "androidx.test.runner.AndroidJUnitRunner"

        buildConfigField 'String', 'AUTOLOG_URL', '"https://manager.infomaniak.com/v3/mobile_login"'
        buildConfigField 'String', 'TERMINATE_ACCOUNT_URL', '"https://manager.infomaniak.com/v3/ng/profile/user/dashboard?open-terminate-account-modal"'
        buildConfigField 'String', 'LOGIN_ENDPOINT_URL', '"https://login.infomaniak.com/"'
        buildConfigField 'String', 'INFOMANIAK_API_V1', '"https://api.infomaniak.com/1"'
        buildConfigField 'String', 'INFOMANIAK_API', '"https://api.infomaniak.com/2/"'
        buildConfigField 'String', 'MATOMO_URL', '"https://analytics.infomaniak.com/matomo.php"'

        ksp { arg("room.schemaLocation", "$projectDir/schemas") }
    }

    compileOptions {
        sourceCompatibility javaVersion
        targetCompatibility javaVersion
    }

    buildFeatures {
        viewBinding true
        buildConfig true
    }

    kotlinOptions { jvmTarget = javaVersion }
}

dependencies {

    api core.kotlinx.coroutines.android
    api core.kotlinx.coroutines.test
    api core.kotlinx.serialization.json

    api core.navigation.fragment.ktx
    api core.navigation.ui.ktx

    api core.constraintlayout
    api core.coordinatorlayout
    api core.androidx.core.ktx
    api core.androidx.lifecycle.livedata.ktx
    api core.androidx.recyclerview
    api core.swiperefreshlayout

    api core.appcompat
    api core.appcompat.resources

    implementation core.splitties.appctx

    api core.room.ktx
    api core.room.runtime
    ksp core.room.compiler

    api core.material
    api core.gson

    api core.coil.two

    api core.android.login
    api core.stetho.okhttp3
    api core.okhttp

    api core.sentry.android
    api core.sentry.okhttp

    implementation core.progress.button

    api core.matomo

    testImplementation core.junit
    testImplementation core.androidx.junit
    testImplementation core.androidx.test.core
    testImplementation core.androidx.test.core.ktx
    testImplementation core.robolectric
}
